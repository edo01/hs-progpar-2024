#include <math.h>
#include <stdio.h>

/**
 * -------------------------------------------------------------
 * |  Computation of a root of a polynomial by Newton's method |
 * -------------------------------------------------------------
 * x(  1) = 4.64864864864865e-01, diff = 3.51e-02
 * x(  2) = 4.46871334005382e-01, diff = 1.80e-02
 * x(  3) = 4.37760822617778e-01, diff = 9.11e-03
 * x(  4) = 4.33176135560773e-01, diff = 4.58e-03
 * x(  5) = 4.30876303695783e-01, diff = 2.30e-03
 * x(  6) = 4.29724498961186e-01, diff = 1.15e-03
 * x(  7) = 4.29148122277491e-01, diff = 5.76e-04
 * x(  8) = 4.28859815090413e-01, diff = 2.88e-04
 * x(  9) = 4.28715631752208e-01, diff = 1.44e-04
 * x( 10) = 4.28643532642829e-01, diff = 7.21e-05
 * x( 11) = 4.28607481227673e-01, diff = 3.61e-05
 * x( 12) = 4.28589455054643e-01, diff = 1.80e-05
 * x( 13) = 4.28580441851876e-01, diff = 9.01e-06
 * x( 14) = 4.28575935222086e-01, diff = 4.51e-06
 * x( 15) = 4.28573681897140e-01, diff = 2.25e-06
 * x( 16) = 4.28572555238040e-01, diff = 1.13e-06
 * x( 17) = 4.28571991917912e-01, diff = 5.63e-07
 * x( 18) = 4.28571710252326e-01, diff = 2.82e-07
 * x( 19) = 4.28571569423332e-01, diff = 1.41e-07
 * x( 20) = 4.28571499110523e-01, diff = 7.03e-08
 * x( 21) = 4.28571463978568e-01, diff = 3.51e-08
 * x( 22) = 4.28571446417224e-01, diff = 1.76e-08
 * x( 23) = 4.28571437832772e-01, diff = 8.58e-09
 * x( 24) = 4.28571432967630e-01, diff = 4.87e-09
 * x( 25) = 4.28571430917781e-01, diff = 2.05e-09
 * x( 26) = 4.28571434758445e-01, diff = 3.84e-09
 * x( 27) = 4.28571433301918e-01, diff = 1.46e-09
 * x( 28) = 4.28571431396925e-01, diff = 1.90e-09
 * x( 29) = 4.28571428207557e-01, diff = 3.19e-09
 * x( 30) = 4.28571403441845e-01, diff = 2.48e-08
 * x( 31) = 4.28571415992959e-01, diff = 1.26e-08
 * x( 32) = 4.28571421007946e-01, diff = 5.01e-09
 * x( 33) = 4.28571424582311e-01, diff = 3.57e-09
 * x( 34) = 4.28571422323278e-01, diff = 2.26e-09
 * x( 35) = 4.28571425207827e-01, diff = 2.88e-09
 * x( 36) = 4.28571425207827e-01, diff = 0.00e+00
 */

int main()
{
  int i, nmax=100;
  double y, x, diff, eps=1.e-12; 
  printf("-------------------------------------------------------------\n");
  printf("|  Computation of a root of a polynomial by Newton's method |\n");
  printf("-------------------------------------------------------------\n");
  
  y = 0.5;
  for(i = 1;i<=nmax;i++){
    x = y;
    y = x-(1.47*pow(x,3)+1.19*pow(x,2)-1.83*x+0.45)/
      (4.41*pow(x,2)+2.38*x-1.83);
    diff = fabs(x-y);
    printf("x(%3d) = %.14e, diff = %.2e\n", i, y, diff);     
    if (diff<eps) break;
  }
  return 0;
}
